import{I as h,J as e,p as r}from"./index-ADMgmOFv.js";import{S as c}from"./sweetalert2.all-CAdgv-ta.js";var u={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"dorayu",BASE_URL:"/vite-deploy-week08/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:i,VITE_PATH:o}=u,g=h("cartStore",{state:()=>({cartList:{},carts:{},total:0,isLoading:!1,status:{loadCart:"",loadQty:""}}),actions:{addCart(t,a=1){const s=`${i}/api/${o}/cart`;this.status.loadCart=t;const n={data:{product_id:t,qty:a}};e.post(s,n).then(d=>{this.status.loadCart="",this.getCarts(),r.success(d.data.message)}).catch(d=>{r.error(d.response.data.message)})},getCarts(){const t=`${i}/api/${o}/cart`;this.isLoading=!0,e.get(t).then(a=>{const{data:s}=a.data;this.isLoading=!1,this.cartList=s,this.carts=s.carts,this.total=s.total}).catch(a=>{c.fire(a.response.data.message)})},removeCartItem(t){const a=`${i}/api/${o}/cart/${t}`;this.status.loadQty=t,e.delete(a).then(s=>{r.success(s.data.message),this.status.loadQty="",this.getCarts()}).catch(s=>{r.error(s.response.data.message)})},deleteAllCarts(){const t=`${i}/api/${o}/carts`;c.fire({title:"確定要刪除全部購物車嗎?",showDenyButton:!0,confirmButtonText:"是，我要刪除",denyButtonText:"不要刪除"}).then(a=>{a.isConfirmed&&e.delete(t).then(s=>{this.getCarts(),c.fire(s.data.message)}).catch(s=>{r.error(s.response.data.message)})})},updateCart(t){const a=`${i}/api/${o}/cart/${t.id}`,s={data:{product_id:t.product_id,qty:t.qty}};this.status.loadQty=t.id,e.put(a,s).then(()=>{this.status.loadQty="",this.getCarts()}).catch(n=>{c.fire(n.response.data.message)})}},getters:{cartsLengthComputed(){return this.cartList&&this.cartList.carts?this.cartList.carts.length:0},finalPrice(){const t=this.cartList.total;if(this.cartList&&this.cartList.carts&&this.cartList.carts.length>0){const{coupon:a}=this.cartList.carts[0];return a&&t>=500?t-a.percent:t}return t}}});export{g as c};
