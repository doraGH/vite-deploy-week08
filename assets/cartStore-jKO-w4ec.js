import{G as h,H as e,i as r}from"./index-hv3GUEaf.js";import{S as c}from"./sweetalert2.all-GaRjTAm_.js";var u={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"dorayu",BASE_URL:"/vite-deploy-week08/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:i,VITE_PATH:o}=u,g=h("cartStore",{state:()=>({cartList:{},isLoading:!1,status:{loadCart:"",loadQty:""}}),actions:{addCart(t,s=1){const a=`${i}/api/${o}/cart`;this.status.loadCart=t;const n={data:{product_id:t,qty:s}};e.post(a,n).then(d=>{this.status.loadCart="",this.getCarts(),r.success(d.data.message)}).catch(d=>{r.error(d.response.data.message)})},getCarts(){const t=`${i}/api/${o}/cart`;this.isLoading=!0,e.get(t).then(s=>{const{data:a}=s.data;this.isLoading=!1,this.cartList=a}).catch(s=>{c.fire(s.response.data.message)})},removeCartItem(t){const s=`${i}/api/${o}/cart/${t}`;this.status.loadQty=t,e.delete(s).then(a=>{r.success(a.data.message),this.status.loadQty="",this.getCarts()}).catch(a=>{r.error(a.response.data.message)})},deleteAllCarts(){const t=`${i}/api/${o}/carts`;c.fire({title:"確定要刪除全部購物車嗎?",showDenyButton:!0,confirmButtonText:"是，我要刪除",denyButtonText:"不要刪除"}).then(s=>{s.isConfirmed&&e.delete(t).then(a=>{this.getCarts(),c.fire(a.data.message)}).catch(a=>{r.error(a.response.data.message)})})},updateCart(t){const s=`${i}/api/${o}/cart/${t.id}`,a={data:{product_id:t.product_id,qty:t.qty}};this.status.loadQty=t.id,e.put(s,a).then(()=>{this.status.loadQty="",this.getCarts()}).catch(n=>{c.fire(n.response.data.message)})}},getters:{cartsLengthComputed(){return this.cartList&&this.cartList.carts?this.cartList.carts.length:0},finalPrice(){const t=this.cartList.total;if(this.cartList&&this.cartList.carts&&this.cartList.carts.length>0){const{coupon:s}=this.cartList.carts[0];return s&&t>=500?t-s.percent:t}return t}}});export{g as c};
